{"ast":null,"code":"import _objectSpread from\"/Users/denielleoliva/Downloads/fcp_unr/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useEffect}from'react';import{Download,Play,Trash2,Square,Circle,Pen,Move,Save}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function VectorDrawTTS(){const[tool,setTool]=useState('pen');const[mode,setMode]=useState('draw');const[color,setColor]=useState('#000000');const[penSize,setPenSize]=useState(3);const[brushStyle,setBrushStyle]=useState('solid');// 'solid', 'dashed', 'dotted', 'sketch'\nconst[paths,setPaths]=useState([]);const[currentPath,setCurrentPath]=useState(null);const[isDrawing,setIsDrawing]=useState(false);const[text,setText]=useState('');const[isAnimating,setIsAnimating]=useState(false);const[mouthOpenAmount,setMouthOpenAmount]=useState(0);const[blinkAmount,setBlinkAmount]=useState(0);// 0 = open, 1 = closed\nconst[pupilOffsetX,setPupilOffsetX]=useState(0);const[pupilOffsetY,setPupilOffsetY]=useState(0);const svgRef=useRef(null);const[controlPoints,setControlPoints]=useState({leftEye:{x:300,y:200},rightEye:{x:500,y:200},leftEyebrow:{x:300,y:150},rightEyebrow:{x:500,y:150},mouthLeft:{x:350,y:350},mouthRight:{x:450,y:350},mouthTop:{x:400,y:330},mouthBottom:{x:400,y:370}});const[draggingPoint,setDraggingPoint]=useState(null);// Force re-render when mouthOpenAmount changes\nuseEffect(()=>{if(isAnimating){// Force component update\n}},[mouthOpenAmount,isAnimating]);const getMousePos=e=>{const rect=svgRef.current.getBoundingClientRect();const scaleX=800/rect.width;const scaleY=600/rect.height;// Handle touch events\nlet clientX,clientY;if(e.touches&&e.touches.length>0){clientX=e.touches[0].clientX;clientY=e.touches[0].clientY;}else if(e.changedTouches&&e.changedTouches.length>0){clientX=e.changedTouches[0].clientX;clientY=e.changedTouches[0].clientY;}else{clientX=e.clientX;clientY=e.clientY;}return{x:(clientX-rect.left)*scaleX,y:(clientY-rect.top)*scaleY};};const handleMouseDown=e=>{// Prevent default touch behavior (scrolling)\nif(e.touches){e.preventDefault();}const pos=getMousePos(e);if(mode==='rig'){for(const[key,point]of Object.entries(controlPoints)){const dx=pos.x-point.x;const dy=pos.y-point.y;const dist=Math.sqrt(dx*dx+dy*dy);if(dist<15){setDraggingPoint(key);return;}}}if(mode!=='draw')return;setIsDrawing(true);if(tool==='pen'){setCurrentPath({type:'path',d:\"M \".concat(pos.x,\" \").concat(pos.y),color:color,fill:'none',stroke:color,strokeWidth:penSize,brushStyle:brushStyle});}else if(tool==='rect'){setCurrentPath({type:'rect',x:pos.x,y:pos.y,startX:pos.x,startY:pos.y,width:0,height:0,color:color,fill:color,stroke:color,strokeWidth:penSize});}else if(tool==='circle'){setCurrentPath({type:'circle',cx:pos.x,cy:pos.y,startX:pos.x,startY:pos.y,r:0,color:color,fill:color,stroke:color,strokeWidth:penSize});}};const handleMouseMove=e=>{// Prevent default touch behavior (scrolling)\nif(e.touches){e.preventDefault();}const pos=getMousePos(e);if(draggingPoint){setControlPoints(prev=>_objectSpread(_objectSpread({},prev),{},{[draggingPoint]:{x:pos.x,y:pos.y}}));return;}if(!isDrawing||!currentPath||mode!=='draw')return;if(tool==='pen'){setCurrentPath(prev=>_objectSpread(_objectSpread({},prev),{},{d:\"\".concat(prev.d,\" L \").concat(pos.x,\" \").concat(pos.y)}));}else if(tool==='rect'){const width=pos.x-currentPath.startX;const height=pos.y-currentPath.startY;setCurrentPath(prev=>_objectSpread(_objectSpread({},prev),{},{x:width<0?pos.x:prev.startX,y:height<0?pos.y:prev.startY,width:Math.abs(width),height:Math.abs(height)}));}else if(tool==='circle'){const dx=pos.x-currentPath.startX;const dy=pos.y-currentPath.startY;const radius=Math.sqrt(dx*dx+dy*dy);setCurrentPath(prev=>_objectSpread(_objectSpread({},prev),{},{r:radius}));}};const handleMouseUp=()=>{if(currentPath){setPaths([...paths,currentPath]);setCurrentPath(null);}setIsDrawing(false);setDraggingPoint(null);};const exportSVG=()=>{const svg=svgRef.current;const serializer=new XMLSerializer();const svgString=serializer.serializeToString(svg);const blob=new Blob([svgString],{type:'image/svg+xml'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='drawing.svg';a.click();URL.revokeObjectURL(url);};const exportJSON=()=>{const data={paths:paths,controlPoints:controlPoints};const json=JSON.stringify(data,null,2);const blob=new Blob([json],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='face-rigging.json';a.click();URL.revokeObjectURL(url);};const exportAnimationHTML=()=>{// Create standalone HTML file with animation\nconst htmlContent=\"<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n    <meta charset=\\\"UTF-8\\\">\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n    <title>Animated Face</title>\\n    <style>\\n        * {\\n            margin: 0;\\n            padding: 0;\\n            box-sizing: border-box;\\n        }\\n        body {\\n            background: #f0f0f0;\\n            display: flex;\\n            justify-content: center;\\n            align-items: center;\\n            min-height: 100vh;\\n            font-family: Arial, sans-serif;\\n        }\\n        #container {\\n            background: white;\\n            border-radius: 12px;\\n            box-shadow: 0 4px 6px rgba(0,0,0,0.1);\\n            padding: 20px;\\n        }\\n        svg {\\n            display: block;\\n            max-width: 100%;\\n            height: auto;\\n        }\\n        #controls {\\n            margin-top: 20px;\\n            text-align: center;\\n        }\\n        textarea {\\n            width: 100%;\\n            max-width: 600px;\\n            padding: 10px;\\n            border: 2px solid #ddd;\\n            border-radius: 8px;\\n            font-size: 16px;\\n            resize: vertical;\\n        }\\n        button {\\n            margin-top: 10px;\\n            padding: 12px 24px;\\n            background: #8b5cf6;\\n            color: white;\\n            border: none;\\n            border-radius: 8px;\\n            font-size: 16px;\\n            cursor: pointer;\\n            font-weight: bold;\\n        }\\n        button:hover {\\n            background: #7c3aed;\\n        }\\n        button:disabled {\\n            background: #ccc;\\n            cursor: not-allowed;\\n        }\\n    </style>\\n</head>\\n<body>\\n    <div id=\\\"container\\\">\\n        <svg id=\\\"faceSVG\\\" width=\\\"800\\\" height=\\\"600\\\" viewBox=\\\"0 0 800 600\\\">\\n            <rect width=\\\"800\\\" height=\\\"600\\\" fill=\\\"white\\\" />\\n        </svg>\\n        <div id=\\\"controls\\\">\\n            <textarea id=\\\"textInput\\\" rows=\\\"3\\\" placeholder=\\\"Enter text to speak...\\\">Hello! I am an animated face.</textarea>\\n            <br>\\n            <button id=\\\"animateBtn\\\">Animate with Speech</button>\\n        </div>\\n    </div>\\n\\n    <script>\\n        // Face data\\n        const paths = \".concat(JSON.stringify(paths),\";\\n        const controlPoints = \").concat(JSON.stringify(controlPoints),\";\\n        \\n        // Animation state\\n        let isAnimating = false;\\n        let mouthOpenAmount = 0;\\n        let blinkAmount = 0;\\n        let pupilOffsetX = 0;\\n        let pupilOffsetY = 0;\\n\\n        // Get path animation type\\n        function getPathAnimationType(path) {\\n            const cp = controlPoints;\\n            let pathCenterX, pathCenterY;\\n            \\n            if (path.type === 'circle') {\\n                pathCenterX = path.cx;\\n                pathCenterY = path.cy;\\n            } else if (path.type === 'rect') {\\n                pathCenterX = path.x + path.width / 2;\\n                pathCenterY = path.y + path.height / 2;\\n            } else if (path.type === 'path') {\\n                const points = [];\\n                const commands = path.d.match(/[ML]\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/g);\\n                if (commands) {\\n                    commands.forEach(cmd => {\\n                        const match = cmd.match(/([\\\\d.]+)\\\\s+([\\\\d.]+)/);\\n                        if (match) {\\n                            points.push({ x: parseFloat(match[1]), y: parseFloat(match[2]) });\\n                        }\\n                    });\\n                }\\n                if (points.length === 0) return null;\\n                const minX = Math.min(...points.map(p => p.x));\\n                const maxX = Math.max(...points.map(p => p.x));\\n                const minY = Math.min(...points.map(p => p.y));\\n                const maxY = Math.max(...points.map(p => p.y));\\n                pathCenterX = (minX + maxX) / 2;\\n                pathCenterY = (minY + maxY) / 2;\\n            } else {\\n                return null;\\n            }\\n\\n            const distanceToPoint = (px, py) => {\\n                const dx = pathCenterX - px;\\n                const dy = pathCenterY - py;\\n                return Math.sqrt(dx * dx + dy * dy);\\n            };\\n\\n            const distToLeftEye = distanceToPoint(cp.leftEye.x, cp.leftEye.y);\\n            const distToRightEye = distanceToPoint(cp.rightEye.x, cp.rightEye.y);\\n            \\n            if (distToLeftEye < 15) return { type: 'leftPupil', eyeX: cp.leftEye.x, eyeY: cp.leftEye.y };\\n            if (distToRightEye < 15) return { type: 'rightPupil', eyeX: cp.rightEye.x, eyeY: cp.rightEye.y };\\n            if (distToLeftEye < 40) return { type: 'leftEye', eyeX: cp.leftEye.x, eyeY: cp.leftEye.y };\\n            if (distToRightEye < 40) return { type: 'rightEye', eyeX: cp.rightEye.x, eyeY: cp.rightEye.y };\\n\\n            const mouthCenterX = (cp.mouthLeft.x + cp.mouthRight.x) / 2;\\n            const mouthCenterY = (cp.mouthTop.y + cp.mouthBottom.y) / 2;\\n            const distToMouth = distanceToPoint(mouthCenterX, mouthCenterY);\\n            \\n            if (distToMouth < 120) return { type: 'mouth', centerX: pathCenterX, centerY: pathCenterY };\\n\\n            const distToLeftBrow = distanceToPoint(cp.leftEyebrow.x, cp.leftEyebrow.y);\\n            const distToRightBrow = distanceToPoint(cp.rightEyebrow.x, cp.rightEyebrow.y);\\n            \\n            if (distToLeftBrow < 60 || distToRightBrow < 60) return { type: 'eyebrow' };\\n\\n            return null;\\n        }\\n\\n        // Render animated path\\n        function renderAnimatedPath(path, svg) {\\n            const animInfo = getPathAnimationType(path);\\n            let animatedPath = { ...path };\\n            \\n            if (animInfo && isAnimating) {\\n                if (animInfo.type === 'mouth' && mouthOpenAmount > 0) {\\n                    const scaleY = 1 + (mouthOpenAmount * 0.8);\\n                    if (path.type === 'circle') {\\n                        animatedPath.r = path.r * scaleY;\\n                    } else if (path.type === 'rect') {\\n                        const newHeight = path.height * scaleY;\\n                        const heightDiff = newHeight - path.height;\\n                        animatedPath.y = path.y - heightDiff / 2;\\n                        animatedPath.height = newHeight;\\n                    } else if (path.type === 'path') {\\n                        const centerY = animInfo.centerY;\\n                        const commands = path.d.match(/[ML]\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/g);\\n                        if (commands) {\\n                            let newD = '';\\n                            commands.forEach(cmd => {\\n                                const match = cmd.match(/([ML])\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/);\\n                                if (match) {\\n                                    const command = match[1];\\n                                    const x = parseFloat(match[2]);\\n                                    const y = parseFloat(match[3]);\\n                                    const scaledY = centerY + (y - centerY) * scaleY;\\n                                    newD += command + ' ' + x + ' ' + scaledY + ' ';\\n                                }\\n                            });\\n                            animatedPath.d = newD.trim();\\n                        }\\n                    }\\n                } else if (animInfo.type === 'eyebrow' && mouthOpenAmount > 0) {\\n                    const translateY = -5 * mouthOpenAmount;\\n                    if (path.type === 'circle') {\\n                        animatedPath.cy = path.cy + translateY;\\n                    } else if (path.type === 'rect') {\\n                        animatedPath.y = path.y + translateY;\\n                    } else if (path.type === 'path') {\\n                        const commands = path.d.match(/[ML]\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/g);\\n                        if (commands) {\\n                            let newD = '';\\n                            commands.forEach(cmd => {\\n                                const match = cmd.match(/([ML])\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/);\\n                                if (match) {\\n                                    const command = match[1];\\n                                    const x = parseFloat(match[2]);\\n                                    const y = parseFloat(match[3]) + translateY;\\n                                    newD += command + ' ' + x + ' ' + y + ' ';\\n                                }\\n                            });\\n                            animatedPath.d = newD.trim();\\n                        }\\n                    }\\n                } else if ((animInfo.type === 'leftEye' || animInfo.type === 'rightEye') && blinkAmount > 0) {\\n                    const scaleY = 1 - (blinkAmount * 0.9);\\n                    if (path.type === 'circle') {\\n                        animatedPath.r = path.r * scaleY;\\n                    } else if (path.type === 'rect') {\\n                        const newHeight = path.height * scaleY;\\n                        const heightDiff = path.height - newHeight;\\n                        animatedPath.y = path.y + heightDiff / 2;\\n                        animatedPath.height = newHeight;\\n                    } else if (path.type === 'path') {\\n                        const centerY = animInfo.eyeY;\\n                        const commands = path.d.match(/[ML]\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/g);\\n                        if (commands) {\\n                            let newD = '';\\n                            commands.forEach(cmd => {\\n                                const match = cmd.match(/([ML])\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/);\\n                                if (match) {\\n                                    const command = match[1];\\n                                    const x = parseFloat(match[2]);\\n                                    const y = parseFloat(match[3]);\\n                                    const scaledY = centerY + (y - centerY) * scaleY;\\n                                    newD += command + ' ' + x + ' ' + scaledY + ' ';\\n                                }\\n                            });\\n                            animatedPath.d = newD.trim();\\n                        }\\n                    }\\n                } else if ((animInfo.type === 'leftPupil' || animInfo.type === 'rightPupil') && (pupilOffsetX !== 0 || pupilOffsetY !== 0)) {\\n                    if (path.type === 'circle') {\\n                        animatedPath.cx = path.cx + pupilOffsetX;\\n                        animatedPath.cy = path.cy + pupilOffsetY;\\n                    } else if (path.type === 'rect') {\\n                        animatedPath.x = path.x + pupilOffsetX;\\n                        animatedPath.y = path.y + pupilOffsetY;\\n                    } else if (path.type === 'path') {\\n                        const commands = path.d.match(/[ML]\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/g);\\n                        if (commands) {\\n                            let newD = '';\\n                            commands.forEach(cmd => {\\n                                const match = cmd.match(/([ML])\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/);\\n                                if (match) {\\n                                    const command = match[1];\\n                                    const x = parseFloat(match[2]) + pupilOffsetX;\\n                                    const y = parseFloat(match[3]) + pupilOffsetY;\\n                                    newD += command + ' ' + x + ' ' + y + ' ';\\n                                }\\n                            });\\n                            animatedPath.d = newD.trim();\\n                        }\\n                    }\\n                }\\n            }\\n\\n            let element;\\n            if (animatedPath.type === 'path') {\\n                element = document.createElementNS('http://www.w3.org/2000/svg', 'path');\\n                element.setAttribute('d', animatedPath.d);\\n                element.setAttribute('fill', animatedPath.fill);\\n                element.setAttribute('stroke', animatedPath.stroke);\\n                element.setAttribute('stroke-width', animatedPath.strokeWidth);\\n                element.setAttribute('stroke-linecap', 'round');\\n                element.setAttribute('stroke-linejoin', 'round');\\n            } else if (animatedPath.type === 'rect') {\\n                element = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\\n                element.setAttribute('x', animatedPath.x);\\n                element.setAttribute('y', animatedPath.y);\\n                element.setAttribute('width', animatedPath.width);\\n                element.setAttribute('height', animatedPath.height);\\n                element.setAttribute('fill', animatedPath.fill);\\n                element.setAttribute('stroke', animatedPath.stroke);\\n                element.setAttribute('stroke-width', animatedPath.strokeWidth);\\n            } else if (animatedPath.type === 'circle') {\\n                element = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\\n                element.setAttribute('cx', animatedPath.cx);\\n                element.setAttribute('cy', animatedPath.cy);\\n                element.setAttribute('r', animatedPath.r);\\n                element.setAttribute('fill', animatedPath.fill);\\n                element.setAttribute('stroke', animatedPath.stroke);\\n                element.setAttribute('stroke-width', animatedPath.strokeWidth);\\n            }\\n            \\n            element.style.transition = 'all 0.1s ease-out';\\n            return element;\\n        }\\n\\n        // Render all paths\\n        function render() {\\n            const svg = document.getElementById('faceSVG');\\n            // Clear previous paths (keep background rect)\\n            while (svg.children.length > 1) {\\n                svg.removeChild(svg.lastChild);\\n            }\\n            \\n            paths.forEach(path => {\\n                const element = renderAnimatedPath(path, svg);\\n                svg.appendChild(element);\\n            });\\n        }\\n\\n        // Animation functions\\n        function animateMouth() {\\n            const amplitude = 0.5 + Math.random() * 0.5;\\n            mouthOpenAmount = amplitude;\\n            render();\\n            setTimeout(() => {\\n                mouthOpenAmount = 0;\\n                render();\\n            }, 80 + Math.random() * 120);\\n        }\\n\\n        function animateBlink() {\\n            blinkAmount = 1;\\n            render();\\n            setTimeout(() => {\\n                blinkAmount = 0;\\n                render();\\n            }, 150);\\n        }\\n\\n        function animatePupils() {\\n            const maxOffset = 3;\\n            pupilOffsetX = (Math.random() - 0.5) * maxOffset;\\n            pupilOffsetY = (Math.random() - 0.5) * maxOffset;\\n            render();\\n        }\\n\\n        // Animate with TTS\\n        function animateWithTTS() {\\n            const text = document.getElementById('textInput').value;\\n            if (!text.trim()) {\\n                alert('Please enter text to speak');\\n                return;\\n            }\\n\\n            isAnimating = true;\\n            mouthOpenAmount = 0;\\n            blinkAmount = 0;\\n            pupilOffsetX = 0;\\n            pupilOffsetY = 0;\\n            \\n            const btn = document.getElementById('animateBtn');\\n            btn.disabled = true;\\n            btn.textContent = 'Speaking...';\\n\\n            const utterance = new SpeechSynthesisUtterance(text);\\n            utterance.rate = 0.9;\\n            utterance.pitch = 1;\\n\\n            let mouthInterval, blinkInterval, pupilInterval;\\n            \\n            utterance.onstart = () => {\\n                mouthInterval = setInterval(animateMouth, 150);\\n                blinkInterval = setInterval(animateBlink, 2000 + Math.random() * 2000);\\n                pupilInterval = setInterval(animatePupils, 1000 + Math.random() * 1000);\\n            };\\n\\n            utterance.onend = () => {\\n                clearInterval(mouthInterval);\\n                clearInterval(blinkInterval);\\n                clearInterval(pupilInterval);\\n                isAnimating = false;\\n                mouthOpenAmount = 0;\\n                blinkAmount = 0;\\n                pupilOffsetX = 0;\\n                pupilOffsetY = 0;\\n                render();\\n                btn.disabled = false;\\n                btn.textContent = 'Animate with Speech';\\n            };\\n\\n            window.speechSynthesis.speak(utterance);\\n        }\\n\\n        // Initial render\\n        render();\\n\\n        // Event listener\\n        document.getElementById('animateBtn').addEventListener('click', animateWithTTS);\\n    </script>\\n</body>\\n</html>\");const blob=new Blob([htmlContent],{type:'text/html'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='animated-face.html';a.click();URL.revokeObjectURL(url);};const animateMouth=()=>{const amplitude=0.5+Math.random()*0.5;setMouthOpenAmount(amplitude);setTimeout(()=>{setMouthOpenAmount(0);},80+Math.random()*120);};const animateBlink=()=>{// Quick blink\nsetBlinkAmount(1);setTimeout(()=>{setBlinkAmount(0);},150);};const animatePupils=()=>{// Random subtle eye movement\nconst maxOffset=3;// pixels\nsetPupilOffsetX((Math.random()-0.5)*maxOffset);setPupilOffsetY((Math.random()-0.5)*maxOffset);};const animateWithTTS=async()=>{if(!text.trim()){alert('Please enter text to speak');return;}setIsAnimating(true);setMouthOpenAmount(0);setBlinkAmount(0);setPupilOffsetX(0);setPupilOffsetY(0);setMode('animate');const utterance=new SpeechSynthesisUtterance(text);utterance.rate=0.9;utterance.pitch=1;let mouthIntervalId,blinkIntervalId,pupilIntervalId;utterance.onstart=()=>{// Mouth animation\nmouthIntervalId=setInterval(()=>{animateMouth();},150);// Random blinking (every 2-4 seconds)\nblinkIntervalId=setInterval(()=>{animateBlink();},2000+Math.random()*2000);// Pupil movement (every 1-2 seconds)\npupilIntervalId=setInterval(()=>{animatePupils();},1000+Math.random()*1000);};utterance.onend=()=>{clearInterval(mouthIntervalId);clearInterval(blinkIntervalId);clearInterval(pupilIntervalId);setIsAnimating(false);setMouthOpenAmount(0);setBlinkAmount(0);setPupilOffsetX(0);setPupilOffsetY(0);};window.speechSynthesis.speak(utterance);};const clearCanvas=()=>{setPaths([]);setCurrentPath(null);};const resetControlPoints=()=>{setControlPoints({leftEye:{x:300,y:200},rightEye:{x:500,y:200},leftEyebrow:{x:300,y:150},rightEyebrow:{x:500,y:150},mouthLeft:{x:350,y:350},mouthRight:{x:450,y:350},mouthTop:{x:400,y:330},mouthBottom:{x:400,y:370}});};const getBrushStyle=brushStyle=>{switch(brushStyle){case'dashed':return'10,5';case'dotted':return'2,4';case'sketch':return'8,3,2,3';default:return'none';}};const getPathAnimationType=path=>{const cp=controlPoints;let pathCenterX,pathCenterY;if(path.type==='circle'){pathCenterX=path.cx;pathCenterY=path.cy;}else if(path.type==='rect'){pathCenterX=path.x+path.width/2;pathCenterY=path.y+path.height/2;}else if(path.type==='path'){// For pen paths, calculate center from all points\nconst points=[];const commands=path.d.match(/[ML]\\s*([\\d.]+)\\s+([\\d.]+)/g);if(commands){commands.forEach(cmd=>{const match=cmd.match(/([\\d.]+)\\s+([\\d.]+)/);if(match){points.push({x:parseFloat(match[1]),y:parseFloat(match[2])});}});}if(points.length===0)return null;// Calculate bounding box center\nconst minX=Math.min(...points.map(p=>p.x));const maxX=Math.max(...points.map(p=>p.x));const minY=Math.min(...points.map(p=>p.y));const maxY=Math.max(...points.map(p=>p.y));pathCenterX=(minX+maxX)/2;pathCenterY=(minY+maxY)/2;}else{return null;}const distanceToPoint=(px,py)=>{const dx=pathCenterX-px;const dy=pathCenterY-py;return Math.sqrt(dx*dx+dy*dy);};// Check for pupils (inner circle, closer to eye center)\nconst distToLeftEye=distanceToPoint(cp.leftEye.x,cp.leftEye.y);const distToRightEye=distanceToPoint(cp.rightEye.x,cp.rightEye.y);if(distToLeftEye<15){return{type:'leftPupil',eyeX:cp.leftEye.x,eyeY:cp.leftEye.y};}if(distToRightEye<15){return{type:'rightPupil',eyeX:cp.rightEye.x,eyeY:cp.rightEye.y};}// Check for eye shapes (outer circle, near eye but not pupil)\nif(distToLeftEye<40){return{type:'leftEye',eyeX:cp.leftEye.x,eyeY:cp.leftEye.y};}if(distToRightEye<40){return{type:'rightEye',eyeX:cp.rightEye.x,eyeY:cp.rightEye.y};}const mouthCenterX=(cp.mouthLeft.x+cp.mouthRight.x)/2;const mouthCenterY=(cp.mouthTop.y+cp.mouthBottom.y)/2;const distToMouth=distanceToPoint(mouthCenterX,mouthCenterY);if(distToMouth<120){return{type:'mouth',centerX:pathCenterX,centerY:pathCenterY};}const distToLeftBrow=distanceToPoint(cp.leftEyebrow.x,cp.leftEyebrow.y);const distToRightBrow=distanceToPoint(cp.rightEyebrow.x,cp.rightEyebrow.y);if(distToLeftBrow<60||distToRightBrow<60){return{type:'eyebrow'};}return null;};const renderPath=(path,index)=>{const animInfo=getPathAnimationType(path);// Calculate animated properties directly\nlet animatedPath=_objectSpread({},path);let isAnimated=false;if(animInfo&&isAnimating&&(mouthOpenAmount>0||blinkAmount>0||pupilOffsetX!==0||pupilOffsetY!==0)){isAnimated=true;if(animInfo.type==='mouth'){// For mouth animation, scale the shape\nconst scaleY=1+mouthOpenAmount*0.8;if(path.type==='circle'){const newR=path.r*scaleY;animatedPath=_objectSpread(_objectSpread({},path),{},{r:newR});}else if(path.type==='rect'){const newHeight=path.height*scaleY;const heightDiff=newHeight-path.height;animatedPath=_objectSpread(_objectSpread({},path),{},{y:path.y-heightDiff/2,height:newHeight});}else if(path.type==='path'){const centerY=animInfo.centerY;const commands=path.d.match(/[ML]\\s*([\\d.]+)\\s+([\\d.]+)/g);if(commands){let newD='';commands.forEach(cmd=>{const match=cmd.match(/([ML])\\s*([\\d.]+)\\s+([\\d.]+)/);if(match){const command=match[1];const x=parseFloat(match[2]);const y=parseFloat(match[3]);const scaledY=centerY+(y-centerY)*scaleY;newD+=\"\".concat(command,\" \").concat(x,\" \").concat(scaledY,\" \");}});animatedPath=_objectSpread(_objectSpread({},path),{},{d:newD.trim()});}}}else if(animInfo.type==='eyebrow'){const translateY=-5*mouthOpenAmount;if(path.type==='circle'){animatedPath=_objectSpread(_objectSpread({},path),{},{cy:path.cy+translateY});}else if(path.type==='rect'){animatedPath=_objectSpread(_objectSpread({},path),{},{y:path.y+translateY});}else if(path.type==='path'){const commands=path.d.match(/[ML]\\s*([\\d.]+)\\s+([\\d.]+)/g);if(commands){let newD='';commands.forEach(cmd=>{const match=cmd.match(/([ML])\\s*([\\d.]+)\\s+([\\d.]+)/);if(match){const command=match[1];const x=parseFloat(match[2]);const y=parseFloat(match[3])+translateY;newD+=\"\".concat(command,\" \").concat(x,\" \").concat(y,\" \");}});animatedPath=_objectSpread(_objectSpread({},path),{},{d:newD.trim()});}}}else if(animInfo.type==='leftEye'||animInfo.type==='rightEye'){// Blink animation - squash eye vertically\nconst scaleY=1-blinkAmount*0.9;// Almost close completely\nif(path.type==='circle'){const centerY=path.cy;const newCy=centerY;const newR=path.r*scaleY;animatedPath=_objectSpread(_objectSpread({},path),{},{cy:newCy,r:newR});}else if(path.type==='rect'){const newHeight=path.height*scaleY;const heightDiff=path.height-newHeight;animatedPath=_objectSpread(_objectSpread({},path),{},{y:path.y+heightDiff/2,height:newHeight});}else if(path.type==='path'){const centerY=animInfo.eyeY;const commands=path.d.match(/[ML]\\s*([\\d.]+)\\s+([\\d.]+)/g);if(commands){let newD='';commands.forEach(cmd=>{const match=cmd.match(/([ML])\\s*([\\d.]+)\\s+([\\d.]+)/);if(match){const command=match[1];const x=parseFloat(match[2]);const y=parseFloat(match[3]);const scaledY=centerY+(y-centerY)*scaleY;newD+=\"\".concat(command,\" \").concat(x,\" \").concat(scaledY,\" \");}});animatedPath=_objectSpread(_objectSpread({},path),{},{d:newD.trim()});}}}else if(animInfo.type==='leftPupil'||animInfo.type==='rightPupil'){// Pupil movement\nif(path.type==='circle'){animatedPath=_objectSpread(_objectSpread({},path),{},{cx:path.cx+pupilOffsetX,cy:path.cy+pupilOffsetY});}else if(path.type==='rect'){animatedPath=_objectSpread(_objectSpread({},path),{},{x:path.x+pupilOffsetX,y:path.y+pupilOffsetY});}else if(path.type==='path'){const commands=path.d.match(/[ML]\\s*([\\d.]+)\\s+([\\d.]+)/g);if(commands){let newD='';commands.forEach(cmd=>{const match=cmd.match(/([ML])\\s*([\\d.]+)\\s+([\\d.]+)/);if(match){const command=match[1];const x=parseFloat(match[2])+pupilOffsetX;const y=parseFloat(match[3])+pupilOffsetY;newD+=\"\".concat(command,\" \").concat(x,\" \").concat(y,\" \");}});animatedPath=_objectSpread(_objectSpread({},path),{},{d:newD.trim()});}}}}// Add highlight for shapes that are being animated (debug)\nconst debugHighlight=animInfo&&mode==='animate'?{filter:isAnimated?'drop-shadow(0 0 8px rgba(255, 0, 0, 0.8))':'drop-shadow(0 0 4px rgba(0, 255, 0, 0.5))'}:{};const transitionStyle=_objectSpread({transition:'all 0.1s ease-out'},debugHighlight);if(animatedPath.type==='path'){const strokeDasharray=animatedPath.brushStyle?getBrushStyle(animatedPath.brushStyle):'none';return/*#__PURE__*/_jsx(\"path\",{d:animatedPath.d,fill:animatedPath.fill,stroke:animatedPath.stroke,strokeWidth:animatedPath.strokeWidth,strokeDasharray:strokeDasharray,strokeLinecap:\"round\",strokeLinejoin:\"round\",style:transitionStyle},index);}else if(animatedPath.type==='rect'){return/*#__PURE__*/_jsx(\"rect\",{x:animatedPath.x,y:animatedPath.y,width:animatedPath.width,height:animatedPath.height,fill:animatedPath.fill,stroke:animatedPath.stroke,strokeWidth:animatedPath.strokeWidth,style:transitionStyle},index);}else if(animatedPath.type==='circle'){return/*#__PURE__*/_jsx(\"circle\",{cx:animatedPath.cx,cy:animatedPath.cy,r:animatedPath.r,fill:animatedPath.fill,stroke:animatedPath.stroke,strokeWidth:animatedPath.strokeWidth,style:transitionStyle},index);}};const renderControlPoint=(key,point,color,label)=>{return/*#__PURE__*/_jsxs(\"g\",{children:[/*#__PURE__*/_jsx(\"circle\",{cx:point.x,cy:point.y,r:\"12\",fill:\"white\",stroke:color,strokeWidth:\"3\",style:{cursor:mode==='rig'?'grab':'default',filter:'drop-shadow(0 2px 4px rgba(0,0,0,0.2))'}}),/*#__PURE__*/_jsx(\"circle\",{cx:point.x,cy:point.y,r:\"6\",fill:color,opacity:\"0.8\"}),/*#__PURE__*/_jsx(\"text\",{x:point.x,y:point.y-20,textAnchor:\"middle\",fill:color,fontSize:\"11\",fontWeight:\"bold\",style:{pointerEvents:'none'},children:label})]},key);};const renderSkeleton=()=>{if(mode!=='rig')return null;const cp=controlPoints;return/*#__PURE__*/_jsxs(\"g\",{children:[/*#__PURE__*/_jsxs(\"g\",{stroke:\"#64748b\",strokeWidth:\"2\",strokeDasharray:\"5,5\",opacity:\"0.5\",children:[/*#__PURE__*/_jsx(\"line\",{x1:cp.leftEyebrow.x,y1:cp.leftEyebrow.y,x2:cp.leftEye.x,y2:cp.leftEye.y}),/*#__PURE__*/_jsx(\"line\",{x1:cp.rightEyebrow.x,y1:cp.rightEyebrow.y,x2:cp.rightEye.x,y2:cp.rightEye.y}),/*#__PURE__*/_jsx(\"line\",{x1:cp.mouthLeft.x,y1:cp.mouthLeft.y,x2:cp.mouthTop.x,y2:cp.mouthTop.y}),/*#__PURE__*/_jsx(\"line\",{x1:cp.mouthTop.x,y1:cp.mouthTop.y,x2:cp.mouthRight.x,y2:cp.mouthRight.y}),/*#__PURE__*/_jsx(\"line\",{x1:cp.mouthRight.x,y1:cp.mouthRight.y,x2:cp.mouthBottom.x,y2:cp.mouthBottom.y}),/*#__PURE__*/_jsx(\"line\",{x1:cp.mouthBottom.x,y1:cp.mouthBottom.y,x2:cp.mouthLeft.x,y2:cp.mouthLeft.y}),/*#__PURE__*/_jsx(\"line\",{x1:(cp.leftEye.x+cp.rightEye.x)/2,y1:cp.leftEye.y,x2:(cp.mouthLeft.x+cp.mouthRight.x)/2,y2:cp.mouthTop.y})]}),renderControlPoint('leftEye',cp.leftEye,'#3b82f6','L EYE'),renderControlPoint('rightEye',cp.rightEye,'#3b82f6','R EYE'),renderControlPoint('leftEyebrow',cp.leftEyebrow,'#8b5cf6','L BROW'),renderControlPoint('rightEyebrow',cp.rightEyebrow,'#8b5cf6','R BROW'),renderControlPoint('mouthLeft',cp.mouthLeft,'#ec4899','M LEFT'),renderControlPoint('mouthRight',cp.mouthRight,'#ec4899','M RIGHT'),renderControlPoint('mouthTop',cp.mouthTop,'#ec4899','M TOP'),renderControlPoint('mouthBottom',cp.mouthBottom,'#ec4899','M BOT')]});};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-6xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-bold text-gray-800 mb-2\",children:\"Face Rigging Studio\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6\",children:\"Draw, rig with control points, and animate with speech\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2 bg-white rounded-lg shadow-lg p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mb-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setMode('draw');setDraggingPoint(null);},className:\"px-4 py-2 rounded-lg font-medium transition-all \".concat(mode==='draw'?'bg-purple-600 text-white shadow-md':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(Pen,{className:\"inline mr-2\",size:18}),\"Draw\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setMode('rig'),className:\"px-4 py-2 rounded-lg font-medium transition-all \".concat(mode==='rig'?'bg-blue-600 text-white shadow-md':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(Move,{className:\"inline mr-2\",size:18}),\"Rig Points\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setMode('animate'),className:\"px-4 py-2 rounded-lg font-medium transition-all \".concat(mode==='animate'?'bg-green-600 text-white shadow-md':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(Play,{className:\"inline mr-2\",size:18}),\"Animate\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-blue-50 rounded-lg text-sm\",children:[mode==='draw'&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-blue-800\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Draw Mode:\"}),\" Use the tools below to draw your face\"]}),mode==='rig'&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-blue-800\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Rig Mode:\"}),\" Drag the control points to position them on your drawing\"]}),mode==='animate'&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-blue-800\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Animate Mode:\"}),\" Enter text and click \\\"Animate with Speech\\\"!\"]})]}),mode==='draw'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 flex-wrap\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setTool('pen'),className:\"p-3 rounded-lg transition-all \".concat(tool==='pen'?'bg-purple-600 text-white shadow-md':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:/*#__PURE__*/_jsx(Pen,{size:20})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setTool('rect'),className:\"p-3 rounded-lg transition-all \".concat(tool==='rect'?'bg-purple-600 text-white shadow-md':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:/*#__PURE__*/_jsx(Square,{size:20})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setTool('circle'),className:\"p-3 rounded-lg transition-all \".concat(tool==='circle'?'bg-purple-600 text-white shadow-md':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:/*#__PURE__*/_jsx(Circle,{size:20})})]}),/*#__PURE__*/_jsx(\"input\",{type:\"color\",value:color,onChange:e=>setColor(e.target.value),className:\"w-12 h-12 rounded cursor-pointer border-2 border-gray-300\"}),/*#__PURE__*/_jsx(\"button\",{onClick:clearCanvas,className:\"p-3 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-all\",children:/*#__PURE__*/_jsx(Trash2,{size:20})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-6 flex-wrap bg-gray-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-700\",children:\"Size:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"1\",max:\"20\",value:penSize,onChange:e=>setPenSize(parseInt(e.target.value)),className:\"w-32\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-gray-600 w-8\",children:[penSize,\"px\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-700\",children:\"Brush:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setBrushStyle('solid'),className:\"px-3 py-1.5 text-xs rounded transition-all \".concat(brushStyle==='solid'?'bg-purple-600 text-white':'bg-white text-gray-700 border border-gray-300 hover:bg-gray-100'),children:\"Solid\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setBrushStyle('dashed'),className:\"px-3 py-1.5 text-xs rounded transition-all \".concat(brushStyle==='dashed'?'bg-purple-600 text-white':'bg-white text-gray-700 border border-gray-300 hover:bg-gray-100'),children:\"Dashed\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setBrushStyle('dotted'),className:\"px-3 py-1.5 text-xs rounded transition-all \".concat(brushStyle==='dotted'?'bg-purple-600 text-white':'bg-white text-gray-700 border border-gray-300 hover:bg-gray-100'),children:\"Dotted\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setBrushStyle('sketch'),className:\"px-3 py-1.5 text-xs rounded transition-all \".concat(brushStyle==='sketch'?'bg-purple-600 text-white':'bg-white text-gray-700 border border-gray-300 hover:bg-gray-100'),children:\"Sketch\"})]})]})]}),mode==='rig'&&/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-4 mb-4 flex-wrap\",children:/*#__PURE__*/_jsx(\"button\",{onClick:resetControlPoints,className:\"px-4 py-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-all\",children:\"Reset Points\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-4 border-gray-300 rounded-lg overflow-hidden bg-white relative\",children:[mode==='rig'&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-2 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-lg z-10\",children:\"Adjust by dragging the points\"}),/*#__PURE__*/_jsxs(\"svg\",{ref:svgRef,width:\"800\",height:\"600\",viewBox:\"0 0 800 600\",className:\"w-full h-auto \".concat(mode==='draw'?'cursor-crosshair':mode==='rig'?'cursor-grab':'cursor-default'),onMouseDown:handleMouseDown,onMouseMove:handleMouseMove,onMouseUp:handleMouseUp,onMouseLeave:handleMouseUp,onTouchStart:handleMouseDown,onTouchMove:handleMouseMove,onTouchEnd:handleMouseUp,style:{touchAction:'none'},children:[/*#__PURE__*/_jsx(\"rect\",{width:\"800\",height:\"600\",fill:\"white\"}),paths.map((path,index)=>renderPath(path,index)),currentPath&&renderPath(currentPath,-1),renderSkeleton()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 mt-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:exportSVG,className:\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all\",children:[/*#__PURE__*/_jsx(Download,{size:18}),\"Export SVG\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:exportJSON,className:\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all\",children:[/*#__PURE__*/_jsx(Save,{size:18}),\"Save Rigging\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:exportAnimationHTML,className:\"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all\",children:[/*#__PURE__*/_jsx(Download,{size:18}),\"Export Animation\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 mb-4\",children:\"Speech Animation\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Speech Text\"}),/*#__PURE__*/_jsx(\"textarea\",{value:text,onChange:e=>setText(e.target.value),placeholder:\"Enter text to speak...\",className:\"w-full h-32 px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none resize-none\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:animateWithTTS,disabled:isAnimating,className:\"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-medium transition-all \".concat(isAnimating?'bg-gray-300 text-gray-500 cursor-not-allowed':'bg-purple-600 text-white hover:bg-purple-700 shadow-md hover:shadow-lg'),children:isAnimating?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-5 h-5 border-3 border-white border-t-transparent rounded-full animate-spin\"}),\"Speaking...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Play,{size:20}),\"Animate with Speech\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 p-4 bg-purple-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-800 mb-2\",children:\"How to use:\"}),/*#__PURE__*/_jsxs(\"ol\",{className:\"text-sm text-gray-600 space-y-2 list-decimal list-inside\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Draw:\"}),\" Create your face\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Rig:\"}),\" Drag mouth points to your drawn mouth area\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Animate:\"}),\" Click animate and watch!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-4 bg-yellow-50 border-2 border-yellow-200 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-yellow-800 font-medium\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Debug Info:\"}),/*#__PURE__*/_jsx(\"br\",{}),\"Mouth open: \",(mouthOpenAmount*100).toFixed(0),\"%\",/*#__PURE__*/_jsx(\"br\",{}),\"Blink: \",(blinkAmount*100).toFixed(0),\"%\",/*#__PURE__*/_jsx(\"br\",{}),\"Animating: \",isAnimating?'YES':'NO',/*#__PURE__*/_jsx(\"br\",{}),\"Total shapes: \",paths.length,/*#__PURE__*/_jsx(\"br\",{}),\"Mouth: \",paths.filter(p=>{const info=getPathAnimationType(p);return info&&info.type==='mouth';}).length,/*#__PURE__*/_jsx(\"br\",{}),\"Eyes: \",paths.filter(p=>{const info=getPathAnimationType(p);return info&&(info.type==='leftEye'||info.type==='rightEye');}).length,/*#__PURE__*/_jsx(\"br\",{}),\"Pupils: \",paths.filter(p=>{const info=getPathAnimationType(p);return info&&(info.type==='leftPupil'||info.type==='rightPupil');}).length,/*#__PURE__*/_jsx(\"br\",{}),\"Eyebrows: \",paths.filter(p=>{const info=getPathAnimationType(p);return info&&info.type==='eyebrow';}).length]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-yellow-700 mt-2\",children:\"Green glow = detected, Red glow = animating\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-700 mb-2 text-sm\",children:\"Animation Zones:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-600 space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"span\",{className:\"text-pink-600\",children:\"Mouth:\"}),\" 120px from center\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"span\",{className:\"text-purple-600\",children:\"Eyebrows:\"}),\" 60px radius\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-600\",children:\"Eyes:\"}),\" 40px from eye points\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"span\",{className:\"text-cyan-600\",children:\"Pupils:\"}),\" 15px from eye center\"]})]})]})]})]})]})});}","map":{"version":3,"names":["React","useState","useRef","useEffect","Download","Play","Trash2","Square","Circle","Pen","Move","Save","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","VectorDrawTTS","tool","setTool","mode","setMode","color","setColor","penSize","setPenSize","brushStyle","setBrushStyle","paths","setPaths","currentPath","setCurrentPath","isDrawing","setIsDrawing","text","setText","isAnimating","setIsAnimating","mouthOpenAmount","setMouthOpenAmount","blinkAmount","setBlinkAmount","pupilOffsetX","setPupilOffsetX","pupilOffsetY","setPupilOffsetY","svgRef","controlPoints","setControlPoints","leftEye","x","y","rightEye","leftEyebrow","rightEyebrow","mouthLeft","mouthRight","mouthTop","mouthBottom","draggingPoint","setDraggingPoint","getMousePos","e","rect","current","getBoundingClientRect","scaleX","width","scaleY","height","clientX","clientY","touches","length","changedTouches","left","top","handleMouseDown","preventDefault","pos","key","point","Object","entries","dx","dy","dist","Math","sqrt","type","d","concat","fill","stroke","strokeWidth","startX","startY","cx","cy","r","handleMouseMove","prev","_objectSpread","abs","radius","handleMouseUp","exportSVG","svg","serializer","XMLSerializer","svgString","serializeToString","blob","Blob","url","URL","createObjectURL","a","document","createElement","href","download","click","revokeObjectURL","exportJSON","data","json","JSON","stringify","exportAnimationHTML","htmlContent","animateMouth","amplitude","random","setTimeout","animateBlink","animatePupils","maxOffset","animateWithTTS","trim","alert","utterance","SpeechSynthesisUtterance","rate","pitch","mouthIntervalId","blinkIntervalId","pupilIntervalId","onstart","setInterval","onend","clearInterval","window","speechSynthesis","speak","clearCanvas","resetControlPoints","getBrushStyle","getPathAnimationType","path","cp","pathCenterX","pathCenterY","points","commands","match","forEach","cmd","push","parseFloat","minX","min","map","p","maxX","max","minY","maxY","distanceToPoint","px","py","distToLeftEye","distToRightEye","eyeX","eyeY","mouthCenterX","mouthCenterY","distToMouth","centerX","centerY","distToLeftBrow","distToRightBrow","renderPath","index","animInfo","animatedPath","isAnimated","newR","newHeight","heightDiff","newD","command","scaledY","translateY","newCy","debugHighlight","filter","transitionStyle","transition","strokeDasharray","strokeLinecap","strokeLinejoin","style","renderControlPoint","label","children","cursor","opacity","textAnchor","fontSize","fontWeight","pointerEvents","renderSkeleton","x1","y1","x2","y2","className","onClick","size","value","onChange","target","parseInt","ref","viewBox","onMouseDown","onMouseMove","onMouseUp","onMouseLeave","onTouchStart","onTouchMove","onTouchEnd","touchAction","placeholder","disabled","toFixed","info"],"sources":["/Users/denielleoliva/Downloads/fcp_unr/src/App.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { Download, Play, Trash2, Square, Circle, Pen, Move, Save } from 'lucide-react';\n\nexport default function VectorDrawTTS() {\n  const [tool, setTool] = useState('pen');\n  const [mode, setMode] = useState('draw');\n  const [color, setColor] = useState('#000000');\n  const [penSize, setPenSize] = useState(3);\n  const [brushStyle, setBrushStyle] = useState('solid'); // 'solid', 'dashed', 'dotted', 'sketch'\n  const [paths, setPaths] = useState([]);\n  const [currentPath, setCurrentPath] = useState(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [text, setText] = useState('');\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [mouthOpenAmount, setMouthOpenAmount] = useState(0);\n  const [blinkAmount, setBlinkAmount] = useState(0); // 0 = open, 1 = closed\n  const [pupilOffsetX, setPupilOffsetX] = useState(0);\n  const [pupilOffsetY, setPupilOffsetY] = useState(0);\n  const svgRef = useRef(null);\n\n  const [controlPoints, setControlPoints] = useState({\n    leftEye: { x: 300, y: 200 },\n    rightEye: { x: 500, y: 200 },\n    leftEyebrow: { x: 300, y: 150 },\n    rightEyebrow: { x: 500, y: 150 },\n    mouthLeft: { x: 350, y: 350 },\n    mouthRight: { x: 450, y: 350 },\n    mouthTop: { x: 400, y: 330 },\n    mouthBottom: { x: 400, y: 370 }\n  });\n\n  const [draggingPoint, setDraggingPoint] = useState(null);\n\n  // Force re-render when mouthOpenAmount changes\n  useEffect(() => {\n    if (isAnimating) {\n      // Force component update\n    }\n  }, [mouthOpenAmount, isAnimating]);\n\n  const getMousePos = (e) => {\n    const rect = svgRef.current.getBoundingClientRect();\n    const scaleX = 800 / rect.width;\n    const scaleY = 600 / rect.height;\n    \n    // Handle touch events\n    let clientX, clientY;\n    if (e.touches && e.touches.length > 0) {\n      clientX = e.touches[0].clientX;\n      clientY = e.touches[0].clientY;\n    } else if (e.changedTouches && e.changedTouches.length > 0) {\n      clientX = e.changedTouches[0].clientX;\n      clientY = e.changedTouches[0].clientY;\n    } else {\n      clientX = e.clientX;\n      clientY = e.clientY;\n    }\n    \n    return {\n      x: (clientX - rect.left) * scaleX,\n      y: (clientY - rect.top) * scaleY\n    };\n  };\n\n  const handleMouseDown = (e) => {\n    // Prevent default touch behavior (scrolling)\n    if (e.touches) {\n      e.preventDefault();\n    }\n    \n    const pos = getMousePos(e);\n\n    if (mode === 'rig') {\n      for (const [key, point] of Object.entries(controlPoints)) {\n        const dx = pos.x - point.x;\n        const dy = pos.y - point.y;\n        const dist = Math.sqrt(dx * dx + dy * dy);\n        if (dist < 15) {\n          setDraggingPoint(key);\n          return;\n        }\n      }\n    }\n\n    if (mode !== 'draw') return;\n\n    setIsDrawing(true);\n    \n    if (tool === 'pen') {\n      setCurrentPath({\n        type: 'path',\n        d: `M ${pos.x} ${pos.y}`,\n        color: color,\n        fill: 'none',\n        stroke: color,\n        strokeWidth: penSize,\n        brushStyle: brushStyle\n      });\n    } else if (tool === 'rect') {\n      setCurrentPath({\n        type: 'rect',\n        x: pos.x,\n        y: pos.y,\n        startX: pos.x,\n        startY: pos.y,\n        width: 0,\n        height: 0,\n        color: color,\n        fill: color,\n        stroke: color,\n        strokeWidth: penSize\n      });\n    } else if (tool === 'circle') {\n      setCurrentPath({\n        type: 'circle',\n        cx: pos.x,\n        cy: pos.y,\n        startX: pos.x,\n        startY: pos.y,\n        r: 0,\n        color: color,\n        fill: color,\n        stroke: color,\n        strokeWidth: penSize\n      });\n    }\n  };\n\n  const handleMouseMove = (e) => {\n    // Prevent default touch behavior (scrolling)\n    if (e.touches) {\n      e.preventDefault();\n    }\n    \n    const pos = getMousePos(e);\n\n    if (draggingPoint) {\n      setControlPoints(prev => ({\n        ...prev,\n        [draggingPoint]: { x: pos.x, y: pos.y }\n      }));\n      return;\n    }\n\n    if (!isDrawing || !currentPath || mode !== 'draw') return;\n\n    if (tool === 'pen') {\n      setCurrentPath(prev => ({\n        ...prev,\n        d: `${prev.d} L ${pos.x} ${pos.y}`\n      }));\n    } else if (tool === 'rect') {\n      const width = pos.x - currentPath.startX;\n      const height = pos.y - currentPath.startY;\n      setCurrentPath(prev => ({\n        ...prev,\n        x: width < 0 ? pos.x : prev.startX,\n        y: height < 0 ? pos.y : prev.startY,\n        width: Math.abs(width),\n        height: Math.abs(height)\n      }));\n    } else if (tool === 'circle') {\n      const dx = pos.x - currentPath.startX;\n      const dy = pos.y - currentPath.startY;\n      const radius = Math.sqrt(dx * dx + dy * dy);\n      setCurrentPath(prev => ({\n        ...prev,\n        r: radius\n      }));\n    }\n  };\n\n  const handleMouseUp = () => {\n    if (currentPath) {\n      setPaths([...paths, currentPath]);\n      setCurrentPath(null);\n    }\n    setIsDrawing(false);\n    setDraggingPoint(null);\n  };\n\n  const exportSVG = () => {\n    const svg = svgRef.current;\n    const serializer = new XMLSerializer();\n    const svgString = serializer.serializeToString(svg);\n    const blob = new Blob([svgString], { type: 'image/svg+xml' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'drawing.svg';\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  const exportJSON = () => {\n    const data = {\n      paths: paths,\n      controlPoints: controlPoints\n    };\n    const json = JSON.stringify(data, null, 2);\n    const blob = new Blob([json], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'face-rigging.json';\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  const exportAnimationHTML = () => {\n    // Create standalone HTML file with animation\n    const htmlContent = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Animated Face</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        body {\n            background: #f0f0f0;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            min-height: 100vh;\n            font-family: Arial, sans-serif;\n        }\n        #container {\n            background: white;\n            border-radius: 12px;\n            box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n            padding: 20px;\n        }\n        svg {\n            display: block;\n            max-width: 100%;\n            height: auto;\n        }\n        #controls {\n            margin-top: 20px;\n            text-align: center;\n        }\n        textarea {\n            width: 100%;\n            max-width: 600px;\n            padding: 10px;\n            border: 2px solid #ddd;\n            border-radius: 8px;\n            font-size: 16px;\n            resize: vertical;\n        }\n        button {\n            margin-top: 10px;\n            padding: 12px 24px;\n            background: #8b5cf6;\n            color: white;\n            border: none;\n            border-radius: 8px;\n            font-size: 16px;\n            cursor: pointer;\n            font-weight: bold;\n        }\n        button:hover {\n            background: #7c3aed;\n        }\n        button:disabled {\n            background: #ccc;\n            cursor: not-allowed;\n        }\n    </style>\n</head>\n<body>\n    <div id=\"container\">\n        <svg id=\"faceSVG\" width=\"800\" height=\"600\" viewBox=\"0 0 800 600\">\n            <rect width=\"800\" height=\"600\" fill=\"white\" />\n        </svg>\n        <div id=\"controls\">\n            <textarea id=\"textInput\" rows=\"3\" placeholder=\"Enter text to speak...\">Hello! I am an animated face.</textarea>\n            <br>\n            <button id=\"animateBtn\">Animate with Speech</button>\n        </div>\n    </div>\n\n    <script>\n        // Face data\n        const paths = ${JSON.stringify(paths)};\n        const controlPoints = ${JSON.stringify(controlPoints)};\n        \n        // Animation state\n        let isAnimating = false;\n        let mouthOpenAmount = 0;\n        let blinkAmount = 0;\n        let pupilOffsetX = 0;\n        let pupilOffsetY = 0;\n\n        // Get path animation type\n        function getPathAnimationType(path) {\n            const cp = controlPoints;\n            let pathCenterX, pathCenterY;\n            \n            if (path.type === 'circle') {\n                pathCenterX = path.cx;\n                pathCenterY = path.cy;\n            } else if (path.type === 'rect') {\n                pathCenterX = path.x + path.width / 2;\n                pathCenterY = path.y + path.height / 2;\n            } else if (path.type === 'path') {\n                const points = [];\n                const commands = path.d.match(/[ML]\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/g);\n                if (commands) {\n                    commands.forEach(cmd => {\n                        const match = cmd.match(/([\\\\d.]+)\\\\s+([\\\\d.]+)/);\n                        if (match) {\n                            points.push({ x: parseFloat(match[1]), y: parseFloat(match[2]) });\n                        }\n                    });\n                }\n                if (points.length === 0) return null;\n                const minX = Math.min(...points.map(p => p.x));\n                const maxX = Math.max(...points.map(p => p.x));\n                const minY = Math.min(...points.map(p => p.y));\n                const maxY = Math.max(...points.map(p => p.y));\n                pathCenterX = (minX + maxX) / 2;\n                pathCenterY = (minY + maxY) / 2;\n            } else {\n                return null;\n            }\n\n            const distanceToPoint = (px, py) => {\n                const dx = pathCenterX - px;\n                const dy = pathCenterY - py;\n                return Math.sqrt(dx * dx + dy * dy);\n            };\n\n            const distToLeftEye = distanceToPoint(cp.leftEye.x, cp.leftEye.y);\n            const distToRightEye = distanceToPoint(cp.rightEye.x, cp.rightEye.y);\n            \n            if (distToLeftEye < 15) return { type: 'leftPupil', eyeX: cp.leftEye.x, eyeY: cp.leftEye.y };\n            if (distToRightEye < 15) return { type: 'rightPupil', eyeX: cp.rightEye.x, eyeY: cp.rightEye.y };\n            if (distToLeftEye < 40) return { type: 'leftEye', eyeX: cp.leftEye.x, eyeY: cp.leftEye.y };\n            if (distToRightEye < 40) return { type: 'rightEye', eyeX: cp.rightEye.x, eyeY: cp.rightEye.y };\n\n            const mouthCenterX = (cp.mouthLeft.x + cp.mouthRight.x) / 2;\n            const mouthCenterY = (cp.mouthTop.y + cp.mouthBottom.y) / 2;\n            const distToMouth = distanceToPoint(mouthCenterX, mouthCenterY);\n            \n            if (distToMouth < 120) return { type: 'mouth', centerX: pathCenterX, centerY: pathCenterY };\n\n            const distToLeftBrow = distanceToPoint(cp.leftEyebrow.x, cp.leftEyebrow.y);\n            const distToRightBrow = distanceToPoint(cp.rightEyebrow.x, cp.rightEyebrow.y);\n            \n            if (distToLeftBrow < 60 || distToRightBrow < 60) return { type: 'eyebrow' };\n\n            return null;\n        }\n\n        // Render animated path\n        function renderAnimatedPath(path, svg) {\n            const animInfo = getPathAnimationType(path);\n            let animatedPath = { ...path };\n            \n            if (animInfo && isAnimating) {\n                if (animInfo.type === 'mouth' && mouthOpenAmount > 0) {\n                    const scaleY = 1 + (mouthOpenAmount * 0.8);\n                    if (path.type === 'circle') {\n                        animatedPath.r = path.r * scaleY;\n                    } else if (path.type === 'rect') {\n                        const newHeight = path.height * scaleY;\n                        const heightDiff = newHeight - path.height;\n                        animatedPath.y = path.y - heightDiff / 2;\n                        animatedPath.height = newHeight;\n                    } else if (path.type === 'path') {\n                        const centerY = animInfo.centerY;\n                        const commands = path.d.match(/[ML]\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/g);\n                        if (commands) {\n                            let newD = '';\n                            commands.forEach(cmd => {\n                                const match = cmd.match(/([ML])\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/);\n                                if (match) {\n                                    const command = match[1];\n                                    const x = parseFloat(match[2]);\n                                    const y = parseFloat(match[3]);\n                                    const scaledY = centerY + (y - centerY) * scaleY;\n                                    newD += command + ' ' + x + ' ' + scaledY + ' ';\n                                }\n                            });\n                            animatedPath.d = newD.trim();\n                        }\n                    }\n                } else if (animInfo.type === 'eyebrow' && mouthOpenAmount > 0) {\n                    const translateY = -5 * mouthOpenAmount;\n                    if (path.type === 'circle') {\n                        animatedPath.cy = path.cy + translateY;\n                    } else if (path.type === 'rect') {\n                        animatedPath.y = path.y + translateY;\n                    } else if (path.type === 'path') {\n                        const commands = path.d.match(/[ML]\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/g);\n                        if (commands) {\n                            let newD = '';\n                            commands.forEach(cmd => {\n                                const match = cmd.match(/([ML])\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/);\n                                if (match) {\n                                    const command = match[1];\n                                    const x = parseFloat(match[2]);\n                                    const y = parseFloat(match[3]) + translateY;\n                                    newD += command + ' ' + x + ' ' + y + ' ';\n                                }\n                            });\n                            animatedPath.d = newD.trim();\n                        }\n                    }\n                } else if ((animInfo.type === 'leftEye' || animInfo.type === 'rightEye') && blinkAmount > 0) {\n                    const scaleY = 1 - (blinkAmount * 0.9);\n                    if (path.type === 'circle') {\n                        animatedPath.r = path.r * scaleY;\n                    } else if (path.type === 'rect') {\n                        const newHeight = path.height * scaleY;\n                        const heightDiff = path.height - newHeight;\n                        animatedPath.y = path.y + heightDiff / 2;\n                        animatedPath.height = newHeight;\n                    } else if (path.type === 'path') {\n                        const centerY = animInfo.eyeY;\n                        const commands = path.d.match(/[ML]\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/g);\n                        if (commands) {\n                            let newD = '';\n                            commands.forEach(cmd => {\n                                const match = cmd.match(/([ML])\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/);\n                                if (match) {\n                                    const command = match[1];\n                                    const x = parseFloat(match[2]);\n                                    const y = parseFloat(match[3]);\n                                    const scaledY = centerY + (y - centerY) * scaleY;\n                                    newD += command + ' ' + x + ' ' + scaledY + ' ';\n                                }\n                            });\n                            animatedPath.d = newD.trim();\n                        }\n                    }\n                } else if ((animInfo.type === 'leftPupil' || animInfo.type === 'rightPupil') && (pupilOffsetX !== 0 || pupilOffsetY !== 0)) {\n                    if (path.type === 'circle') {\n                        animatedPath.cx = path.cx + pupilOffsetX;\n                        animatedPath.cy = path.cy + pupilOffsetY;\n                    } else if (path.type === 'rect') {\n                        animatedPath.x = path.x + pupilOffsetX;\n                        animatedPath.y = path.y + pupilOffsetY;\n                    } else if (path.type === 'path') {\n                        const commands = path.d.match(/[ML]\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/g);\n                        if (commands) {\n                            let newD = '';\n                            commands.forEach(cmd => {\n                                const match = cmd.match(/([ML])\\\\s*([\\\\d.]+)\\\\s+([\\\\d.]+)/);\n                                if (match) {\n                                    const command = match[1];\n                                    const x = parseFloat(match[2]) + pupilOffsetX;\n                                    const y = parseFloat(match[3]) + pupilOffsetY;\n                                    newD += command + ' ' + x + ' ' + y + ' ';\n                                }\n                            });\n                            animatedPath.d = newD.trim();\n                        }\n                    }\n                }\n            }\n\n            let element;\n            if (animatedPath.type === 'path') {\n                element = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n                element.setAttribute('d', animatedPath.d);\n                element.setAttribute('fill', animatedPath.fill);\n                element.setAttribute('stroke', animatedPath.stroke);\n                element.setAttribute('stroke-width', animatedPath.strokeWidth);\n                element.setAttribute('stroke-linecap', 'round');\n                element.setAttribute('stroke-linejoin', 'round');\n            } else if (animatedPath.type === 'rect') {\n                element = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n                element.setAttribute('x', animatedPath.x);\n                element.setAttribute('y', animatedPath.y);\n                element.setAttribute('width', animatedPath.width);\n                element.setAttribute('height', animatedPath.height);\n                element.setAttribute('fill', animatedPath.fill);\n                element.setAttribute('stroke', animatedPath.stroke);\n                element.setAttribute('stroke-width', animatedPath.strokeWidth);\n            } else if (animatedPath.type === 'circle') {\n                element = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n                element.setAttribute('cx', animatedPath.cx);\n                element.setAttribute('cy', animatedPath.cy);\n                element.setAttribute('r', animatedPath.r);\n                element.setAttribute('fill', animatedPath.fill);\n                element.setAttribute('stroke', animatedPath.stroke);\n                element.setAttribute('stroke-width', animatedPath.strokeWidth);\n            }\n            \n            element.style.transition = 'all 0.1s ease-out';\n            return element;\n        }\n\n        // Render all paths\n        function render() {\n            const svg = document.getElementById('faceSVG');\n            // Clear previous paths (keep background rect)\n            while (svg.children.length > 1) {\n                svg.removeChild(svg.lastChild);\n            }\n            \n            paths.forEach(path => {\n                const element = renderAnimatedPath(path, svg);\n                svg.appendChild(element);\n            });\n        }\n\n        // Animation functions\n        function animateMouth() {\n            const amplitude = 0.5 + Math.random() * 0.5;\n            mouthOpenAmount = amplitude;\n            render();\n            setTimeout(() => {\n                mouthOpenAmount = 0;\n                render();\n            }, 80 + Math.random() * 120);\n        }\n\n        function animateBlink() {\n            blinkAmount = 1;\n            render();\n            setTimeout(() => {\n                blinkAmount = 0;\n                render();\n            }, 150);\n        }\n\n        function animatePupils() {\n            const maxOffset = 3;\n            pupilOffsetX = (Math.random() - 0.5) * maxOffset;\n            pupilOffsetY = (Math.random() - 0.5) * maxOffset;\n            render();\n        }\n\n        // Animate with TTS\n        function animateWithTTS() {\n            const text = document.getElementById('textInput').value;\n            if (!text.trim()) {\n                alert('Please enter text to speak');\n                return;\n            }\n\n            isAnimating = true;\n            mouthOpenAmount = 0;\n            blinkAmount = 0;\n            pupilOffsetX = 0;\n            pupilOffsetY = 0;\n            \n            const btn = document.getElementById('animateBtn');\n            btn.disabled = true;\n            btn.textContent = 'Speaking...';\n\n            const utterance = new SpeechSynthesisUtterance(text);\n            utterance.rate = 0.9;\n            utterance.pitch = 1;\n\n            let mouthInterval, blinkInterval, pupilInterval;\n            \n            utterance.onstart = () => {\n                mouthInterval = setInterval(animateMouth, 150);\n                blinkInterval = setInterval(animateBlink, 2000 + Math.random() * 2000);\n                pupilInterval = setInterval(animatePupils, 1000 + Math.random() * 1000);\n            };\n\n            utterance.onend = () => {\n                clearInterval(mouthInterval);\n                clearInterval(blinkInterval);\n                clearInterval(pupilInterval);\n                isAnimating = false;\n                mouthOpenAmount = 0;\n                blinkAmount = 0;\n                pupilOffsetX = 0;\n                pupilOffsetY = 0;\n                render();\n                btn.disabled = false;\n                btn.textContent = 'Animate with Speech';\n            };\n\n            window.speechSynthesis.speak(utterance);\n        }\n\n        // Initial render\n        render();\n\n        // Event listener\n        document.getElementById('animateBtn').addEventListener('click', animateWithTTS);\n    </script>\n</body>\n</html>`;\n\n    const blob = new Blob([htmlContent], { type: 'text/html' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'animated-face.html';\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  const animateMouth = () => {\n    const amplitude = 0.5 + Math.random() * 0.5;\n    setMouthOpenAmount(amplitude);\n    \n    setTimeout(() => {\n      setMouthOpenAmount(0);\n    }, 80 + Math.random() * 120);\n  };\n\n  const animateBlink = () => {\n    // Quick blink\n    setBlinkAmount(1);\n    setTimeout(() => {\n      setBlinkAmount(0);\n    }, 150);\n  };\n\n  const animatePupils = () => {\n    // Random subtle eye movement\n    const maxOffset = 3; // pixels\n    setPupilOffsetX((Math.random() - 0.5) * maxOffset);\n    setPupilOffsetY((Math.random() - 0.5) * maxOffset);\n  };\n\n  const animateWithTTS = async () => {\n    if (!text.trim()) {\n      alert('Please enter text to speak');\n      return;\n    }\n\n    setIsAnimating(true);\n    setMouthOpenAmount(0);\n    setBlinkAmount(0);\n    setPupilOffsetX(0);\n    setPupilOffsetY(0);\n    setMode('animate');\n\n    const utterance = new SpeechSynthesisUtterance(text);\n    utterance.rate = 0.9;\n    utterance.pitch = 1;\n\n    let mouthIntervalId, blinkIntervalId, pupilIntervalId;\n    \n    utterance.onstart = () => {\n      // Mouth animation\n      mouthIntervalId = setInterval(() => {\n        animateMouth();\n      }, 150);\n      \n      // Random blinking (every 2-4 seconds)\n      blinkIntervalId = setInterval(() => {\n        animateBlink();\n      }, 2000 + Math.random() * 2000);\n      \n      // Pupil movement (every 1-2 seconds)\n      pupilIntervalId = setInterval(() => {\n        animatePupils();\n      }, 1000 + Math.random() * 1000);\n    };\n\n    utterance.onend = () => {\n      clearInterval(mouthIntervalId);\n      clearInterval(blinkIntervalId);\n      clearInterval(pupilIntervalId);\n      setIsAnimating(false);\n      setMouthOpenAmount(0);\n      setBlinkAmount(0);\n      setPupilOffsetX(0);\n      setPupilOffsetY(0);\n    };\n\n    window.speechSynthesis.speak(utterance);\n  };\n\n  const clearCanvas = () => {\n    setPaths([]);\n    setCurrentPath(null);\n  };\n\n  const resetControlPoints = () => {\n    setControlPoints({\n      leftEye: { x: 300, y: 200 },\n      rightEye: { x: 500, y: 200 },\n      leftEyebrow: { x: 300, y: 150 },\n      rightEyebrow: { x: 500, y: 150 },\n      mouthLeft: { x: 350, y: 350 },\n      mouthRight: { x: 450, y: 350 },\n      mouthTop: { x: 400, y: 330 },\n      mouthBottom: { x: 400, y: 370 }\n    });\n  };\n\n  const getBrushStyle = (brushStyle) => {\n    switch(brushStyle) {\n      case 'dashed':\n        return '10,5';\n      case 'dotted':\n        return '2,4';\n      case 'sketch':\n        return '8,3,2,3';\n      default:\n        return 'none';\n    }\n  };\n\n  const getPathAnimationType = (path) => {\n    const cp = controlPoints;\n    \n    let pathCenterX, pathCenterY;\n    if (path.type === 'circle') {\n      pathCenterX = path.cx;\n      pathCenterY = path.cy;\n    } else if (path.type === 'rect') {\n      pathCenterX = path.x + path.width / 2;\n      pathCenterY = path.y + path.height / 2;\n    } else if (path.type === 'path') {\n      // For pen paths, calculate center from all points\n      const points = [];\n      const commands = path.d.match(/[ML]\\s*([\\d.]+)\\s+([\\d.]+)/g);\n      \n      if (commands) {\n        commands.forEach(cmd => {\n          const match = cmd.match(/([\\d.]+)\\s+([\\d.]+)/);\n          if (match) {\n            points.push({\n              x: parseFloat(match[1]),\n              y: parseFloat(match[2])\n            });\n          }\n        });\n      }\n      \n      if (points.length === 0) return null;\n      \n      // Calculate bounding box center\n      const minX = Math.min(...points.map(p => p.x));\n      const maxX = Math.max(...points.map(p => p.x));\n      const minY = Math.min(...points.map(p => p.y));\n      const maxY = Math.max(...points.map(p => p.y));\n      \n      pathCenterX = (minX + maxX) / 2;\n      pathCenterY = (minY + maxY) / 2;\n    } else {\n      return null;\n    }\n\n    const distanceToPoint = (px, py) => {\n      const dx = pathCenterX - px;\n      const dy = pathCenterY - py;\n      return Math.sqrt(dx * dx + dy * dy);\n    };\n\n    // Check for pupils (inner circle, closer to eye center)\n    const distToLeftEye = distanceToPoint(cp.leftEye.x, cp.leftEye.y);\n    const distToRightEye = distanceToPoint(cp.rightEye.x, cp.rightEye.y);\n    \n    if (distToLeftEye < 15) {\n      return { type: 'leftPupil', eyeX: cp.leftEye.x, eyeY: cp.leftEye.y };\n    }\n    if (distToRightEye < 15) {\n      return { type: 'rightPupil', eyeX: cp.rightEye.x, eyeY: cp.rightEye.y };\n    }\n\n    // Check for eye shapes (outer circle, near eye but not pupil)\n    if (distToLeftEye < 40) {\n      return { type: 'leftEye', eyeX: cp.leftEye.x, eyeY: cp.leftEye.y };\n    }\n    if (distToRightEye < 40) {\n      return { type: 'rightEye', eyeX: cp.rightEye.x, eyeY: cp.rightEye.y };\n    }\n\n    const mouthCenterX = (cp.mouthLeft.x + cp.mouthRight.x) / 2;\n    const mouthCenterY = (cp.mouthTop.y + cp.mouthBottom.y) / 2;\n    const distToMouth = distanceToPoint(mouthCenterX, mouthCenterY);\n    \n    if (distToMouth < 120) {\n      return { type: 'mouth', centerX: pathCenterX, centerY: pathCenterY };\n    }\n\n    const distToLeftBrow = distanceToPoint(cp.leftEyebrow.x, cp.leftEyebrow.y);\n    const distToRightBrow = distanceToPoint(cp.rightEyebrow.x, cp.rightEyebrow.y);\n    \n    if (distToLeftBrow < 60 || distToRightBrow < 60) {\n      return { type: 'eyebrow' };\n    }\n\n    return null;\n  };\n\n  const renderPath = (path, index) => {\n    const animInfo = getPathAnimationType(path);\n    \n    // Calculate animated properties directly\n    let animatedPath = { ...path };\n    let isAnimated = false;\n    \n    if (animInfo && isAnimating && (mouthOpenAmount > 0 || blinkAmount > 0 || pupilOffsetX !== 0 || pupilOffsetY !== 0)) {\n      isAnimated = true;\n      \n      if (animInfo.type === 'mouth') {\n        // For mouth animation, scale the shape\n        const scaleY = 1 + (mouthOpenAmount * 0.8);\n        \n        if (path.type === 'circle') {\n          const newR = path.r * scaleY;\n          animatedPath = { ...path, r: newR };\n        } else if (path.type === 'rect') {\n          const newHeight = path.height * scaleY;\n          const heightDiff = newHeight - path.height;\n          animatedPath = { ...path, y: path.y - heightDiff / 2, height: newHeight };\n        } else if (path.type === 'path') {\n          const centerY = animInfo.centerY;\n          const commands = path.d.match(/[ML]\\s*([\\d.]+)\\s+([\\d.]+)/g);\n          \n          if (commands) {\n            let newD = '';\n            commands.forEach((cmd) => {\n              const match = cmd.match(/([ML])\\s*([\\d.]+)\\s+([\\d.]+)/);\n              if (match) {\n                const command = match[1];\n                const x = parseFloat(match[2]);\n                const y = parseFloat(match[3]);\n                const scaledY = centerY + (y - centerY) * scaleY;\n                newD += `${command} ${x} ${scaledY} `;\n              }\n            });\n            animatedPath = { ...path, d: newD.trim() };\n          }\n        }\n      } else if (animInfo.type === 'eyebrow') {\n        const translateY = -5 * mouthOpenAmount;\n        \n        if (path.type === 'circle') {\n          animatedPath = { ...path, cy: path.cy + translateY };\n        } else if (path.type === 'rect') {\n          animatedPath = { ...path, y: path.y + translateY };\n        } else if (path.type === 'path') {\n          const commands = path.d.match(/[ML]\\s*([\\d.]+)\\s+([\\d.]+)/g);\n          \n          if (commands) {\n            let newD = '';\n            commands.forEach((cmd) => {\n              const match = cmd.match(/([ML])\\s*([\\d.]+)\\s+([\\d.]+)/);\n              if (match) {\n                const command = match[1];\n                const x = parseFloat(match[2]);\n                const y = parseFloat(match[3]) + translateY;\n                newD += `${command} ${x} ${y} `;\n              }\n            });\n            animatedPath = { ...path, d: newD.trim() };\n          }\n        }\n      } else if (animInfo.type === 'leftEye' || animInfo.type === 'rightEye') {\n        // Blink animation - squash eye vertically\n        const scaleY = 1 - (blinkAmount * 0.9); // Almost close completely\n        \n        if (path.type === 'circle') {\n          const centerY = path.cy;\n          const newCy = centerY;\n          const newR = path.r * scaleY;\n          animatedPath = { ...path, cy: newCy, r: newR };\n        } else if (path.type === 'rect') {\n          const newHeight = path.height * scaleY;\n          const heightDiff = path.height - newHeight;\n          animatedPath = { ...path, y: path.y + heightDiff / 2, height: newHeight };\n        } else if (path.type === 'path') {\n          const centerY = animInfo.eyeY;\n          const commands = path.d.match(/[ML]\\s*([\\d.]+)\\s+([\\d.]+)/g);\n          \n          if (commands) {\n            let newD = '';\n            commands.forEach((cmd) => {\n              const match = cmd.match(/([ML])\\s*([\\d.]+)\\s+([\\d.]+)/);\n              if (match) {\n                const command = match[1];\n                const x = parseFloat(match[2]);\n                const y = parseFloat(match[3]);\n                const scaledY = centerY + (y - centerY) * scaleY;\n                newD += `${command} ${x} ${scaledY} `;\n              }\n            });\n            animatedPath = { ...path, d: newD.trim() };\n          }\n        }\n      } else if (animInfo.type === 'leftPupil' || animInfo.type === 'rightPupil') {\n        // Pupil movement\n        if (path.type === 'circle') {\n          animatedPath = { \n            ...path, \n            cx: path.cx + pupilOffsetX,\n            cy: path.cy + pupilOffsetY\n          };\n        } else if (path.type === 'rect') {\n          animatedPath = { \n            ...path, \n            x: path.x + pupilOffsetX,\n            y: path.y + pupilOffsetY\n          };\n        } else if (path.type === 'path') {\n          const commands = path.d.match(/[ML]\\s*([\\d.]+)\\s+([\\d.]+)/g);\n          \n          if (commands) {\n            let newD = '';\n            commands.forEach((cmd) => {\n              const match = cmd.match(/([ML])\\s*([\\d.]+)\\s+([\\d.]+)/);\n              if (match) {\n                const command = match[1];\n                const x = parseFloat(match[2]) + pupilOffsetX;\n                const y = parseFloat(match[3]) + pupilOffsetY;\n                newD += `${command} ${x} ${y} `;\n              }\n            });\n            animatedPath = { ...path, d: newD.trim() };\n          }\n        }\n      }\n    }\n\n    // Add highlight for shapes that are being animated (debug)\n    const debugHighlight = animInfo && mode === 'animate' ? {\n      filter: isAnimated ? 'drop-shadow(0 0 8px rgba(255, 0, 0, 0.8))' : 'drop-shadow(0 0 4px rgba(0, 255, 0, 0.5))'\n    } : {};\n\n    const transitionStyle = {\n      transition: 'all 0.1s ease-out',\n      ...debugHighlight\n    };\n\n    if (animatedPath.type === 'path') {\n      const strokeDasharray = animatedPath.brushStyle ? getBrushStyle(animatedPath.brushStyle) : 'none';\n      return (\n        <path\n          key={index}\n          d={animatedPath.d}\n          fill={animatedPath.fill}\n          stroke={animatedPath.stroke}\n          strokeWidth={animatedPath.strokeWidth}\n          strokeDasharray={strokeDasharray}\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n          style={transitionStyle}\n        />\n      );\n    } else if (animatedPath.type === 'rect') {\n      return (\n        <rect\n          key={index}\n          x={animatedPath.x}\n          y={animatedPath.y}\n          width={animatedPath.width}\n          height={animatedPath.height}\n          fill={animatedPath.fill}\n          stroke={animatedPath.stroke}\n          strokeWidth={animatedPath.strokeWidth}\n          style={transitionStyle}\n        />\n      );\n    } else if (animatedPath.type === 'circle') {\n      return (\n        <circle\n          key={index}\n          cx={animatedPath.cx}\n          cy={animatedPath.cy}\n          r={animatedPath.r}\n          fill={animatedPath.fill}\n          stroke={animatedPath.stroke}\n          strokeWidth={animatedPath.strokeWidth}\n          style={transitionStyle}\n        />\n      );\n    }\n  };\n\n  const renderControlPoint = (key, point, color, label) => {\n    return (\n      <g key={key}>\n        <circle\n          cx={point.x}\n          cy={point.y}\n          r=\"12\"\n          fill=\"white\"\n          stroke={color}\n          strokeWidth=\"3\"\n          style={{\n            cursor: mode === 'rig' ? 'grab' : 'default',\n            filter: 'drop-shadow(0 2px 4px rgba(0,0,0,0.2))'\n          }}\n        />\n        <circle\n          cx={point.x}\n          cy={point.y}\n          r=\"6\"\n          fill={color}\n          opacity=\"0.8\"\n        />\n        <text\n          x={point.x}\n          y={point.y - 20}\n          textAnchor=\"middle\"\n          fill={color}\n          fontSize=\"11\"\n          fontWeight=\"bold\"\n          style={{ pointerEvents: 'none' }}\n        >\n          {label}\n        </text>\n      </g>\n    );\n  };\n\n  const renderSkeleton = () => {\n    if (mode !== 'rig') return null;\n\n    const cp = controlPoints;\n    \n    return (\n      <g>\n        <g stroke=\"#64748b\" strokeWidth=\"2\" strokeDasharray=\"5,5\" opacity=\"0.5\">\n          <line x1={cp.leftEyebrow.x} y1={cp.leftEyebrow.y} x2={cp.leftEye.x} y2={cp.leftEye.y} />\n          <line x1={cp.rightEyebrow.x} y1={cp.rightEyebrow.y} x2={cp.rightEye.x} y2={cp.rightEye.y} />\n          <line x1={cp.mouthLeft.x} y1={cp.mouthLeft.y} x2={cp.mouthTop.x} y2={cp.mouthTop.y} />\n          <line x1={cp.mouthTop.x} y1={cp.mouthTop.y} x2={cp.mouthRight.x} y2={cp.mouthRight.y} />\n          <line x1={cp.mouthRight.x} y1={cp.mouthRight.y} x2={cp.mouthBottom.x} y2={cp.mouthBottom.y} />\n          <line x1={cp.mouthBottom.x} y1={cp.mouthBottom.y} x2={cp.mouthLeft.x} y2={cp.mouthLeft.y} />\n          <line x1={(cp.leftEye.x + cp.rightEye.x) / 2} y1={cp.leftEye.y} \n                x2={(cp.mouthLeft.x + cp.mouthRight.x) / 2} y2={cp.mouthTop.y} />\n        </g>\n\n        {renderControlPoint('leftEye', cp.leftEye, '#3b82f6', 'L EYE')}\n        {renderControlPoint('rightEye', cp.rightEye, '#3b82f6', 'R EYE')}\n        {renderControlPoint('leftEyebrow', cp.leftEyebrow, '#8b5cf6', 'L BROW')}\n        {renderControlPoint('rightEyebrow', cp.rightEyebrow, '#8b5cf6', 'R BROW')}\n        {renderControlPoint('mouthLeft', cp.mouthLeft, '#ec4899', 'M LEFT')}\n        {renderControlPoint('mouthRight', cp.mouthRight, '#ec4899', 'M RIGHT')}\n        {renderControlPoint('mouthTop', cp.mouthTop, '#ec4899', 'M TOP')}\n        {renderControlPoint('mouthBottom', cp.mouthBottom, '#ec4899', 'M BOT')}\n      </g>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-8\">\n      <div className=\"max-w-6xl mx-auto\">\n        <h1 className=\"text-4xl font-bold text-gray-800 mb-2\">Face Rigging Studio</h1>\n        <p className=\"text-gray-600 mb-6\">Draw, rig with control points, and animate with speech</p>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2 bg-white rounded-lg shadow-lg p-6\">\n            <div className=\"flex gap-2 mb-4\">\n              <button\n                onClick={() => {\n                  setMode('draw');\n                  setDraggingPoint(null);\n                }}\n                className={`px-4 py-2 rounded-lg font-medium transition-all ${\n                  mode === 'draw'\n                    ? 'bg-purple-600 text-white shadow-md'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                <Pen className=\"inline mr-2\" size={18} />\n                Draw\n              </button>\n              <button\n                onClick={() => setMode('rig')}\n                className={`px-4 py-2 rounded-lg font-medium transition-all ${\n                  mode === 'rig'\n                    ? 'bg-blue-600 text-white shadow-md'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                <Move className=\"inline mr-2\" size={18} />\n                Rig Points\n              </button>\n              <button\n                onClick={() => setMode('animate')}\n                className={`px-4 py-2 rounded-lg font-medium transition-all ${\n                  mode === 'animate'\n                    ? 'bg-green-600 text-white shadow-md'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                <Play className=\"inline mr-2\" size={18} />\n                Animate\n              </button>\n            </div>\n\n            <div className=\"mb-4 p-3 bg-blue-50 rounded-lg text-sm\">\n              {mode === 'draw' && (\n                <p className=\"text-blue-800\"><strong>Draw Mode:</strong> Use the tools below to draw your face</p>\n              )}\n              {mode === 'rig' && (\n                <p className=\"text-blue-800\"><strong>Rig Mode:</strong> Drag the control points to position them on your drawing</p>\n              )}\n              {mode === 'animate' && (\n                <p className=\"text-blue-800\"><strong>Animate Mode:</strong> Enter text and click \"Animate with Speech\"!</p>\n              )}\n            </div>\n\n            {mode === 'draw' && (\n              <div className=\"space-y-3 mb-4\">\n                {/* Tool Selection */}\n                <div className=\"flex items-center gap-4 flex-wrap\">\n                  <div className=\"flex gap-2\">\n                    <button\n                      onClick={() => setTool('pen')}\n                      className={`p-3 rounded-lg transition-all ${\n                        tool === 'pen' \n                          ? 'bg-purple-600 text-white shadow-md' \n                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                      }`}\n                    >\n                      <Pen size={20} />\n                    </button>\n                    <button\n                      onClick={() => setTool('rect')}\n                      className={`p-3 rounded-lg transition-all ${\n                        tool === 'rect' \n                          ? 'bg-purple-600 text-white shadow-md' \n                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                      }`}\n                    >\n                      <Square size={20} />\n                    </button>\n                    <button\n                      onClick={() => setTool('circle')}\n                      className={`p-3 rounded-lg transition-all ${\n                        tool === 'circle' \n                          ? 'bg-purple-600 text-white shadow-md' \n                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                      }`}\n                    >\n                      <Circle size={20} />\n                    </button>\n                  </div>\n\n                  <input\n                    type=\"color\"\n                    value={color}\n                    onChange={(e) => setColor(e.target.value)}\n                    className=\"w-12 h-12 rounded cursor-pointer border-2 border-gray-300\"\n                  />\n\n                  <button\n                    onClick={clearCanvas}\n                    className=\"p-3 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-all\"\n                  >\n                    <Trash2 size={20} />\n                  </button>\n                </div>\n\n                {/* Pen Size and Brush Style */}\n                <div className=\"flex items-center gap-6 flex-wrap bg-gray-50 p-3 rounded-lg\">\n                  {/* Pen Size */}\n                  <div className=\"flex items-center gap-3\">\n                    <label className=\"text-sm font-medium text-gray-700\">Size:</label>\n                    <input\n                      type=\"range\"\n                      min=\"1\"\n                      max=\"20\"\n                      value={penSize}\n                      onChange={(e) => setPenSize(parseInt(e.target.value))}\n                      className=\"w-32\"\n                    />\n                    <span className=\"text-sm font-medium text-gray-600 w-8\">{penSize}px</span>\n                  </div>\n\n                  {/* Brush Style */}\n                  <div className=\"flex items-center gap-2\">\n                    <label className=\"text-sm font-medium text-gray-700\">Brush:</label>\n                    <button\n                      onClick={() => setBrushStyle('solid')}\n                      className={`px-3 py-1.5 text-xs rounded transition-all ${\n                        brushStyle === 'solid'\n                          ? 'bg-purple-600 text-white'\n                          : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-100'\n                      }`}\n                    >\n                      Solid\n                    </button>\n                    <button\n                      onClick={() => setBrushStyle('dashed')}\n                      className={`px-3 py-1.5 text-xs rounded transition-all ${\n                        brushStyle === 'dashed'\n                          ? 'bg-purple-600 text-white'\n                          : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-100'\n                      }`}\n                    >\n                      Dashed\n                    </button>\n                    <button\n                      onClick={() => setBrushStyle('dotted')}\n                      className={`px-3 py-1.5 text-xs rounded transition-all ${\n                        brushStyle === 'dotted'\n                          ? 'bg-purple-600 text-white'\n                          : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-100'\n                      }`}\n                    >\n                      Dotted\n                    </button>\n                    <button\n                      onClick={() => setBrushStyle('sketch')}\n                      className={`px-3 py-1.5 text-xs rounded transition-all ${\n                        brushStyle === 'sketch'\n                          ? 'bg-purple-600 text-white'\n                          : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-100'\n                      }`}\n                    >\n                      Sketch\n                    </button>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {mode === 'rig' && (\n              <div className=\"flex items-center gap-4 mb-4 flex-wrap\">\n                <button\n                  onClick={resetControlPoints}\n                  className=\"px-4 py-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-all\"\n                >\n                  Reset Points\n                </button>\n              </div>\n            )}\n\n            <div className=\"border-4 border-gray-300 rounded-lg overflow-hidden bg-white relative\">\n              {mode === 'rig' && (\n                <div className=\"absolute top-2 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-lg z-10\">\n                  Adjust by dragging the points\n                </div>\n              )}\n              \n              <svg\n                ref={svgRef}\n                width=\"800\"\n                height=\"600\"\n                viewBox=\"0 0 800 600\"\n                className={`w-full h-auto ${\n                  mode === 'draw' ? 'cursor-crosshair' : \n                  mode === 'rig' ? 'cursor-grab' : \n                  'cursor-default'\n                }`}\n                onMouseDown={handleMouseDown}\n                onMouseMove={handleMouseMove}\n                onMouseUp={handleMouseUp}\n                onMouseLeave={handleMouseUp}\n                onTouchStart={handleMouseDown}\n                onTouchMove={handleMouseMove}\n                onTouchEnd={handleMouseUp}\n                style={{ touchAction: 'none' }}\n              >\n                <rect width=\"800\" height=\"600\" fill=\"white\" />\n                \n                {paths.map((path, index) => renderPath(path, index))}\n                {currentPath && renderPath(currentPath, -1)}\n                \n                {renderSkeleton()}\n              </svg>\n            </div>\n\n            <div className=\"flex gap-3 mt-4\">\n              <button\n                onClick={exportSVG}\n                className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all\"\n              >\n                <Download size={18} />\n                Export SVG\n              </button>\n              <button\n                onClick={exportJSON}\n                className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all\"\n              >\n                <Save size={18} />\n                Save Rigging\n              </button>\n              <button\n                onClick={exportAnimationHTML}\n                className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all\"\n              >\n                <Download size={18} />\n                Export Animation\n              </button>\n            </div>\n          </div>\n\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\n            <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">Speech Animation</h2>\n            \n            <div className=\"mb-4\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Speech Text\n              </label>\n              <textarea\n                value={text}\n                onChange={(e) => setText(e.target.value)}\n                placeholder=\"Enter text to speak...\"\n                className=\"w-full h-32 px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none resize-none\"\n              />\n            </div>\n\n            <button\n              onClick={animateWithTTS}\n              disabled={isAnimating}\n              className={`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-medium transition-all ${\n                isAnimating\n                  ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\n                  : 'bg-purple-600 text-white hover:bg-purple-700 shadow-md hover:shadow-lg'\n              }`}\n            >\n              {isAnimating ? (\n                <>\n                  <div className=\"w-5 h-5 border-3 border-white border-t-transparent rounded-full animate-spin\" />\n                  Speaking...\n                </>\n              ) : (\n                <>\n                  <Play size={20} />\n                  Animate with Speech\n                </>\n              )}\n            </button>\n\n            <div className=\"mt-6 p-4 bg-purple-50 rounded-lg\">\n              <h3 className=\"font-semibold text-gray-800 mb-2\">How to use:</h3>\n              <ol className=\"text-sm text-gray-600 space-y-2 list-decimal list-inside\">\n                <li><strong>Draw:</strong> Create your face</li>\n                <li><strong>Rig:</strong> Drag mouth points to your drawn mouth area</li>\n                <li><strong>Animate:</strong> Click animate and watch!</li>\n              </ol>\n            </div>\n\n            <div className=\"mt-4 p-4 bg-yellow-50 border-2 border-yellow-200 rounded-lg\">\n              <p className=\"text-sm text-yellow-800 font-medium\">\n                <strong>Debug Info:</strong><br/>\n                Mouth open: {(mouthOpenAmount * 100).toFixed(0)}%<br/>\n                Blink: {(blinkAmount * 100).toFixed(0)}%<br/>\n                Animating: {isAnimating ? 'YES' : 'NO'}<br/>\n                Total shapes: {paths.length}<br/>\n                Mouth: {paths.filter(p => {\n                  const info = getPathAnimationType(p);\n                  return info && info.type === 'mouth';\n                }).length}<br/>\n                Eyes: {paths.filter(p => {\n                  const info = getPathAnimationType(p);\n                  return info && (info.type === 'leftEye' || info.type === 'rightEye');\n                }).length}<br/>\n                Pupils: {paths.filter(p => {\n                  const info = getPathAnimationType(p);\n                  return info && (info.type === 'leftPupil' || info.type === 'rightPupil');\n                }).length}<br/>\n                Eyebrows: {paths.filter(p => {\n                  const info = getPathAnimationType(p);\n                  return info && info.type === 'eyebrow';\n                }).length}\n              </p>\n              <p className=\"text-xs text-yellow-700 mt-2\">\n                Green glow = detected, Red glow = animating\n              </p>\n            </div>\n\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n              <h4 className=\"font-semibold text-gray-700 mb-2 text-sm\">Animation Zones:</h4>\n              <div className=\"text-xs text-gray-600 space-y-1\">\n                <div> <span className=\"text-pink-600\">Mouth:</span> 120px from center</div>\n                <div> <span className=\"text-purple-600\">Eyebrows:</span> 60px radius</div>\n                <div> <span className=\"text-blue-600\">Eyes:</span> 40px from eye points</div>\n                <div> <span className=\"text-cyan-600\">Pupils:</span> 15px from eye center</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}